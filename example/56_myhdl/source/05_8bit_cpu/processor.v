// File: processor.v
// Generated by MyHDL 0.11
// Date: Thu Jun 17 08:11:42 2021


`timescale 1ns/10ps

module processor (
    clk,
    rst,
    di,
    do,
    adr,
    we
);


input clk;
input rst;
input [7:0] di;
input [7:0] do;
output [15:0] adr;
reg [15:0] adr;
input we;

reg [7:0] am;
reg [2:0] cyc;
reg [7:0] im;
reg [7:0] ir;
reg [10:0] pc;



always @(posedge clk) begin: PROCESSOR_LOGIC
    if (rst) begin
        pc <= 0;
        adr <= 0;
    end
    else if ((cyc == 0)) begin
        adr <= (pc + 1);
        pc <= (pc + 1);
        cyc <= 1;
    end
    else if ((cyc == 1)) begin
        adr <= (pc + 1);
        ir <= do;
        cyc <= 2;
    end
    else if ((cyc == 2)) begin
        im <= do;
        am <= (ir & 7);
        ir <= ((ir >>> 3) & 31);
    end
end

endmodule
